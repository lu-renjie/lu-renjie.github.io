---
title: 【推荐系统】模型优化思路
tags: 推荐系统 深度学习 笔记
published: false
---


## 理解推荐系统

推荐系统模型很直接，实质上还是在学特征之间比较基础的联系，比如线性回归的加权，LR的baseline本身结果就很好，不需要学习CV或NLP里面那些很high-level的抽象表征。

### Feedback Loop

- Feedback loop问题。推荐系统决定用户看到的内容，用户的行为会以训练数据或序列特征的形式影响推荐系统，形成一个闭环。这样会导致马太效应：item本身由于内容差异以及冷启动问题会在热度上形成一个长尾分布，而由于推荐系统feedback loop的特征，被推荐得越多的item用户看到的也越多，导致长尾加剧。热门内容越来越热门，冷启动问题需要专门的设计进行解决。

Feedback Loop and Bias Amplification in Recommender Systems

### 用户分层

不同用户的兴趣差异非常大，用户使用APP的目的也各不相同，对用户分层的理解有助于推荐系统的宏观决策。

用户可以按年龄划分，按使用APP时长划分（高价值用户），按职业划分，按性别划分。在跨业务的时候可以迁移其它业务的高价值用户。

APP的用户可以分为深度用户和新回用户（新用户、回流用户、未注册用户），深度用户推荐算法不太会影响他们的留存，更多看平均使用时长，而新用户体验不好可能就不会使用这个APP了，看重DAU。


### 内容分层

公司内部会根据内容标签，比如游戏、生活等内容会由不同的团队设计模型，针对这样更专门的场景进行优化。在AB测试时，一种常出现的情况是在一些内容上负向，但是在其它内容上正向，这个要根据运营目标抉择。

内容可以分为UGC和PGC，内容是流量平台的基石，运营好平台内容非常重要。PGC是平台内的专业内容，可以吸引专业用户或者带有学习目的的用户；UGC是平台内的非专业内容，可以保证平台内容多样性，增强用户互动性。

内容可以按热门度划分，按类别划分等。热门的内容可能是整活，短期热门，也可能是专业度很高的内容，长期热门。


### 各种bias

[推荐系统中的各种bias](https://zhuanlan.zhihu.com/p/428037218)

#### Sample Selection Bias

对于CVR模型，模型用于训练的样本都是clic的样本，但实际推理的时候会对所有send的样本进行CVR预测，包括click和非click的样本，因此存在bias。

CTR模型不存在SSB问题，召粗模型存在SSB问题。

### 线上线下不一致

原因可能有很多，比如模型serving有些问题，特征线上线下不一致。

离线数据训练有提升，但是线上不一定有提升，原因在于：
- 除此之外，在线和离线的实现会有很多差异。
- SSB问题。粗排送过来的数据和训练用的曝光过的数据不同
- 线上存在大量新样本，与离线不一致
- 特征差异：
    - match特征存在穿越问题

[https://zhuanlan.zhihu.com/p/42521586](https://zhuanlan.zhihu.com/p/42521586)
[https://blog.csdn.net/legendavid/article/details/80653433](https://blog.csdn.net/legendavid/article/details/80653433)

#### Position bias

指由于推送内容在app中的位置导致的bias，比如双栏推荐，用户比较喜欢看第一个，用户没有点击的item并不意味着他不感兴趣。

[https://zhuanlan.zhihu.com/p/439499892](https://zhuanlan.zhihu.com/p/439499892)

简单的解决办法是加特征，把位置也作为特征输入进去。


## 精排模型优化

### 特征设计

* 从user journey的角度理解send到action的链路，在链路的每个环节都设计特征，让模型感知全链路。
* 用户分层优化
* 内容分层优化

### 模型

多看论文吧。。。各种纠偏。


## 资源占用优化

### 推理时延优化

半精度推理、减小模型参数量、low-rank的线性层。

### 内存占用优化

* 特征淘汰
* embedding大小调优


