---
title: 【推荐系统】模型优化思路
tags: 推荐系统 深度学习 笔记
published: false
---


## 理解推荐系统

推荐系统模型很直接，实质上还是在学特征之间比较基础的联系，比如线性回归的加权，LR的baseline本身结果就很好，不需要学习CV或NLP里面那些很high-level的抽象表征。

### 推荐系统的闭环

模型影响了用户看到的内容，用户对这些内容的行为会以数据流的形式反馈到模型，进一步影响自己看到的内容，于是形成了一个反馈回路。

### 用户分层

不同用户的兴趣差异非常大，用户使用APP的目的也各不相同，对用户分层的理解有助于推荐系统的宏观决策。

用户可以按年龄划分，按使用APP时长划分，按职业划分，按性别划分。

### 内容分层

公司内部会根据内容标签，比如游戏、生活等内容会由不同的团队设计模型，针对这样更专门的场景进行优化。在AB测试时，一种常出现的情况是在一些内容上负向，但是在其它内容上正向，这个要根据运营目标抉择。

内容可以分为UGC和PGC，内容是流量平台的基石，运营好平台内容非常重要。PGC是平台内的专业内容，可以吸引专业用户或者带有学习目的的用户；UGC是平台内的非专业内容，可以保证平台内容多样性，增强用户互动性。

内容可以按热门度划分，按类别划分等。


### 各种bias

[推荐系统中的各种bias](https://zhuanlan.zhihu.com/p/428037218)

#### Sample Selection Bias

模型用于训练的样本都是send出去的样本，本身就是排序比较靠前的样本。但实际推理的时候又不是这样，因此存在bias。

#### Position bias

指由于推送内容在app中的位置导致的bias，比如双栏推荐，用户比较喜欢看第一个，用户没有点击的item并不意味着他不感兴趣。

[https://zhuanlan.zhihu.com/p/439499892](https://zhuanlan.zhihu.com/p/439499892)

简单的解决办法是加特征，把位置也作为特征输入进去。

### 线上线下不一致

原因可能有很多，比如模型serving有些问题，特征线上线下不一致。

离线数据训练有提升，但是线上不一定有提升，原因在于：
- SSB问题。粗排送过来的数据和训练用的曝光过的数据不同
- 线上受冷启动影响

[https://zhuanlan.zhihu.com/p/42521586](https://zhuanlan.zhihu.com/p/42521586)
[https://blog.csdn.net/legendavid/article/details/80653433](https://blog.csdn.net/legendavid/article/details/80653433)


#### AUC纠偏

AUC指标的问题，数据分布的变化。

- Debias AUC


## 精排模型优化

### 特征设计

* 从user journey的角度理解send到action的链路，在链路的每个环节都设计特征，让模型感知全链路。
* 用户分层优化
* 内容分层优化

### 模型

多看论文吧。。。各种纠偏。


## 资源占用优化

### 推理时延优化

半精度推理、减小模型参数量、low-rank的线性层。

### 内存占用优化

* 特征淘汰
* embedding大小调优


